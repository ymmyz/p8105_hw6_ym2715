P8105\_hw6\_ym2715
================
Yizhi Ma
11/26/2018

Problem 1
---------

``` r
homi_raw = read_csv("https://raw.githubusercontent.com/washingtonpost/data-homicides/master/homicide-data.csv")

homi = homi_raw 
homi$city_state = paste(homi$city, homi$state, sep = ", ")
homi = homi %>% 
  select(-city, -state) %>% 
  filter(city_state != "Dallas, TX",
         city_state != "Phoenix, AZ",
         city_state != "Kansas City, MO",
         city_state != "Tulsa, AL") %>% 
  mutate(victim_race = case_when(victim_race == "White" ~ "white",
                                 TRUE ~ "non-white"),
         victim_race = fct_relevel(victim_race, ref = "white"),
         victim_age = as.numeric(victim_age))
```

``` r
balto_glm = homi %>% 
  filter(city_state == "Baltimore, MD") %>% 
  mutate(disposition = case_when(disposition == "Closed by arrest" ~ 1,
                                 TRUE ~ 0))%>% 
  glm(disposition ~ victim_age + victim_sex + victim_race, data = ., family = binomial())

balto_glm %>% broom::tidy(conf.int = TRUE)
```

    ## # A tibble: 4 x 7
    ##   term            estimate std.error statistic  p.value conf.low conf.high
    ##   <chr>              <dbl>     <dbl>     <dbl>    <dbl>    <dbl>     <dbl>
    ## 1 (Intercept)      1.19      0.235        5.06 4.30e- 7   0.730   1.65    
    ## 2 victim_age      -0.00699   0.00326     -2.14 3.22e- 2  -0.0134 -0.000627
    ## 3 victim_sexMale  -0.888     0.136       -6.53 6.80e-11  -1.16   -0.622   
    ## 4 victim_racenonâ€¦ -0.820     0.175       -4.69 2.68e- 6  -1.16   -0.479

``` r
balto_or_ci = balto_glm %>% 
  broom::tidy(conf.int = TRUE) %>% 
  mutate(odds_ratio = exp(estimate),
         conf_lower = exp(conf.low),
         conf_upper = exp(conf.high)) %>% 
  select(term, odds_ratio, conf_lower, conf_upper) %>% 
  filter(term == "victim_racenon-white")
```
